name: log_kube
dependencies:
  - name: pipebase
    path: ../../../pipebase
    modules: ["pipebase::prelude::*"]
  - name: pipekafka
    path: ../../../pipeware/pipekafka
    modules: ["pipekafka::*"]
  - name: pipekube
    path: ../../../pipeware/pipekube
    modules: ["pipekube::*"]
pipes:
  - name: kube_event
    ty: Listener
    config:
      ty: KubeEventReaderConfig
      path: catalogs/kube_event_reader.yml
    output: 
      ty:
        ExternalObject: KubeEvent
  - name: kafka_json_message
    ty: Mapper
    config:
      ty: KafkaJsonRecordConverterConfig
    output:
      ty:
        Pair:
          lty: 
            Option:
              ty: String
          rty: UnsignedBytes
    upstreams: [kube_event]
  - name: kafka_producer
    ty: Exporter
    config:
      ty: KafkaProducerConfig
      path: catalogs/kafka_producer.yml
    upstreams: [kafka_json_message]