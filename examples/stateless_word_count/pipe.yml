name: stateless_word_count
dependencies:
  - package: pipebase
    path: ../../../pipebase
    modules: ["pipebase::*"]
pipes:
  - name: file_path_visitor
    ty: Listener
    config:
      ty: LocalFilePathVisitorConfig
      path: catalogs/local_file_path_visitor.yml
    output:
      ty: PathBuf
  - name: file_line_reader
    ty: Streamer
    config:
      ty: FileLineReaderConfig
    output:
      ty: String
    upstreams: [file_path_visitor]
  - name: string_space_splitter
    ty: Mapper
    config:
      ty: StringSplitterConfig
      path: catalogs/string_splitter.yml
    output:
      ty:
        Vec:
          ty: String
    upstreams: [file_line_reader]
  - name: word_count
    ty: Mapper
    config: 
      ty: UnorderedGroupAddAggregatorConfig
    output:
      ty:
        Vec:
          ty:
            Pair:
              lty: String
              rty: Count32
    upstreams: [string_space_splitter]
  - name: streamer
    ty: Streamer
    config:
      ty: IteratorReaderConfig
    output:
      ty:
        Pair:
          lty: String
          rty: Count32
    upstreams: [word_count]
  - name: printer
    ty: Exporter
    config:
      ty: PrinterConfig
    upstreams: [streamer]