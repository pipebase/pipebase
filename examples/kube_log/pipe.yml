name: log_kube
dependencies:
  - package: pipebase
    path: ../../../pipebase
    modules: ["pipebase::prelude::*"]
  - package: pipekafka
    path: ../../../pipeware/pipekafka
    modules: ["pipekafka::*"]
  - package: pipekube
    path: ../../../pipeware/pipekube
    modules: ["pipekube::*"]
pipes:
  - name: kube_logger
    ty: Listener
    config:
      ty: KubeLogReaderConfig
      path: catalogs/kube_log_reader.yml
    output: 
      ty:
        ExternalObject: KubeLog
  - name: convert_log
    ty: Mapper
    config:
      ty: ConversionConfig
    output:
      ty:
        Pair:
          lty: String
          rty: String
    upstreams: [kube_logger]
  - name: kafka_producer
    ty: Exporter
    config:
      ty: KafkaProducerConfig
      path: catalogs/kafka_producer.yml
    upstreams: [convert_log]